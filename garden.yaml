# Use "cargo install garden-tools" to install garden https://gitlab.com/garden-rs/garden
#
# Usage:
#   garden fmt                  # Format code using "cercis".
#   garden tox                  # Run tests using "tox"
#   garden grow pages           # Clone mockfs.github.io to pages/.
#   garden doc                  # Generate documentation to pages/.
---
garden:
  root: "${GARDEN_CONFIG_DIR}"

trees:
  mockfs:
    description: A simple mock filesystem for unit tests
    path: "${GARDEN_CONFIG_DIR}"
    url: "git@github.com:mockfs/mockfs.git"
    remotes:
      davvid: "git@github.com:davvid/mockfs.git"
    variables:
      tox_envs: "py36,py37,py38,py39,py310,py311,py312"
    commands:
      doc: |
        python -m sphinx "$@" docs pages
      fmt: |
        cercis --version
        git ls-files -- '*.py' | xargs cercis "$@"
      tox: |
        tox --develop --skip-missing-interpreters --parallel auto -e "${tox_envs}" "$@"

  pages:
    description: mockfs documentation hosted on mockfs.github.io
    url: "git@github.com:mockfs/mockfs.github.io"
